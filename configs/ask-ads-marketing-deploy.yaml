# Ask-Ads-Marketing RAG Configuration - Railway Deployment

knowledge_base:
  name: "Ask Ads & Marketing KB"
  creator: "Marketing Experts"
  topic: "Paid advertising, social media marketing, ad spend optimization, and email strategy"
  description: "Searchable RAG over paid ads, marketing, and social media strategy content"
  personality: "data-driven, results-focused, and ROI-oriented"

data_sources:
  use_source_notes: false
  use_transcripts: true
  prefer_transcripts: true
  transcripts_dir: "/app/transcripts"
  source_notes_dir: "/app/notes"

embeddings:
  provider: "voyage"
  model: "voyage-3.5"
  batch_size: 32  # Voyage has 120K token limit; 32 Ã— 3000 = 96K tokens (safe)
  show_progress: true
  fallback_model: "all-MiniLM-L6-v2"

chunking:
  notes_chunk_size: 1800
  notes_chunk_overlap: 200
  preserve_sections: true
  min_chunk_size: 200
  max_chunk_size: 3000
  transcript_chunk_minutes: 3
  transcript_overlap_seconds: 30

search:
  top_k_initial: 30
  top_k_final: 15
  min_relevance_score: 0.5
  enable_mmr: true
  # BM25 hybrid search with RRF fusion
  hybrid_enabled: true
  hybrid_alpha: 0.7 # 70% vector, 30% BM25
  bm25_index_path: "/app/data/bm25_index.pkl"

# Enrichment with OpenRouter Gemini 3 Flash (~10x cheaper than Anthropic)
metadata_injection:
  enabled: true
  provider: "openrouter"
  model: "google/gemini-3-flash-preview"
  batch_size: 5

# Cohere reranking for final result relevance
reranking:
  enabled: true
  provider: "cohere"
  model: "rerank-english-v3.0"
  initial_k: 30
  final_k: 10

generation:
  provider: "anthropic"
  model: "claude-haiku-4-5-20251001"
  temperature: 0.2
  max_tokens: 2600
  system_prompt: |
    You are a research assistant synthesizing answers from a curated knowledge base. Your job is to extract and organize the most relevant insights from the provided context.

    Only use information explicitly present in the context. If the answer isn't there, say "I don't have specific content on that" rather than guessing. When the context contains frameworks, numbered steps, or direct quotes, preserve them - these are often the most valuable parts.

    Lead with the direct answer, then support it with specifics from the sources. End with a Sources section listing only the titles of referenced content.

chroma:
  persist_directory: "/app/data/chroma_db"
  collection_prefix: "ads_marketing"
  collections:
    content: "content"
    concepts: "concepts"
    metadata: "metadata"

logging:
  level: "INFO"
  file: "ask_ads_marketing_rag.log"

mcp:
  enabled: true
  name: "ask-ads-marketing"

analytics:
  track_queries: true
  track_performance: true
  export_metrics: false
